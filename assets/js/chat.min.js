const form=document.getElementById('chat-form');const input=document.getElementById('chat-input');const messages=document.getElementById('chat-messages');form.addEventListener('submit',async function(e){e.preventDefault();let userMsg=input.value.trim();if(!userMsg)return;userMsg=sanitizeInput(userMsg);appendMessage(userMsg,'user');input.value='';appendTypingIndicator();try{const response=await fetch("http: method: "POST",headers:{"Content-Type": "application/json"},body: JSON.stringify({message: userMsg})});removeTypingIndicator();const data=await response.json();appendMessage(data.reply||"⚠️ No reply from the server.",'bot');}catch(error){console.error("Fetch error:",error);removeTypingIndicator();appendMessage("❌ Error connecting to the chatbot server.",'bot');}});function appendMessage(message,sender){const div=document.createElement('div');div.className=sender==='user' ? 'text-end d-flex justify-content-end' : 'text-start d-flex justify-content-start';const bubble=document.createElement('div');bubble.className=`chat-bubble ${sender==='user' ? 'chat-user' : 'chat-bot'}`;bubble.innerHTML=formatMessageHTML(message);div.appendChild(bubble);messages.appendChild(div);messages.scrollTop=messages.scrollHeight;}function appendTypingIndicator(){const div=document.createElement('div');div.className='text-start d-flex justify-content-start';div.id='typing-indicator';const bubble=document.createElement('div');bubble.className='chat-bubble chat-bot typing-bubble';bubble.innerHTML=`<span class="dot"></span><span class="dot"></span><span class="dot"></span>`;div.appendChild(bubble);messages.appendChild(div);messages.scrollTop=messages.scrollHeight;}function removeTypingIndicator(){const indicator=document.getElementById('typing-indicator');if(indicator)indicator.remove();}function sanitizeInput(input){const div=document.createElement('div');div.textContent=input;return div.innerHTML;}function formatMessageHTML(message){let html=message .replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br>").replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/`(.*?)`/g,'<code class="inline-code">$1</code>').replace(/\[([^\]]+)\]\((https?:\/\/[^\s)]+)\)/g,'<a href="$2" target="_blank" rel="noopener noreferrer">$1</a>');return html;}}document.getElementById('examplePrompts').addEventListener('click',function(e){if(e.target.classList.contains('prompt-chip')){input.value=e.target.textContent;input.focus();}});